#################################################################################
### Data preparations for national-agg King (data matrix with 7 party columns ###
#################################################################################
obj1 <- df2012d0
obj2 <- df2009d0
obj3 <- df2006d0
# national aggregates
S <-          data.frame(pan=obj1$panw, pri=obj1$priw+obj1$pricw, prd=obj1$prdcw, pvem=obj1$pvemw, panal=obj1$panalw, ptc=rep(0,300), asdc=rep(0,300))
S <- apply(S, 2, sum) / 300
tmp <-        data.frame(pan=obj2$panw, pri=obj2$priw+obj2$pricw, prd=obj2$prdw,  pvem=obj2$pvemw, panal=obj2$panalw, ptc=obj2$ptcw, asdc=rep(0,300))
tmp <- apply(tmp, 2, sum) / 300
S <- rbind(S, tmp)
tmp <-        data.frame(pan=obj3$panw, pri=obj3$pricw,           prd=obj3$prdcw, pvem=rep(0,300), panal=obj3$panalw, ptc=rep(0,300), asdc=obj3$asdcw)
tmp <- apply(tmp, 2, sum) / 300
S <- rbind(S, tmp)
# re-does data.frame to check that aggregation went well
S <- data.frame(S=as.vector(S), yr=rep(c(2012,2009,2006),7), pty=c(rep("pan",3),rep("pri",3),rep("prd",3),rep("pvem",3),rep("panal",3),rep("ptc",3),rep("asdc",3)))
S <- S$S
#
# v=R is national vote shares --- Grofman et al 1997 show that its use conflates 3 sources of party bias, so below are options to use other vote shares to separate them
R <-          data.frame(pan=obj1$pan, pri=obj1$pri+obj1$pric, prd=obj1$prdc, pvem=obj1$pvem, panal=obj1$panal, ptc=rep(0,300),  asdc=rep(0,300), efec=obj1$efec)
R <- apply(R, 2, sum)
R <- R[-length(R)] / R[length(R)]
tmp <-        data.frame(pan=obj2$pan, pri=obj2$pri+obj2$pric, prd=obj2$prd,  pvem=obj2$pvem, panal=obj2$panal, ptc=obj2$ptc, asdc=rep(0,300), efec=obj2$efec)
tmp <- apply(tmp, 2, sum)
tmp <- tmp[-length(tmp)] / tmp[length(tmp)]
R <- rbind(R, tmp)

tmp <-    data.frame(pan=obj3$pan, pri=obj3$pric,            prd=obj3$prdc, pvem=rep(0,32),   panal=obj3$panal, ptc=rep(0,32),  asdc=obj3$asdc, efec=obj3$efec)

